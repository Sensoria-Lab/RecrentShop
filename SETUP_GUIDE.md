# Инструкция по запуску проекта Recrent Shop

## Требования

- **Node.js** v16 или выше
- **npm** или **yarn**
- Доступ к базе данных MySQL (SmartASP.NET)

## Установка и запуск

### 1. Клонируйте репозиторий

```bash
git clone https://github.com/Sensoria-Lab/RecrentShop.git
cd RecrentShop
```

### 2. Настройка фронтенда

```bash
# Установите зависимости
npm install

# Создайте файл .env.local
cp .env.example .env.local

# Откройте .env.local и укажите URL бэкенда (по умолчанию http://localhost:5000/api)
```

### 3. Настройка бэкенда

```bash
# Перейдите в папку backend
cd backend

# Установите зависимости
npm install

# Файл .env уже создан с настройками базы данных
# Если нужно изменить настройки, отредактируйте backend/.env

# Инициализируйте базу данных (создание таблиц и админа)
npm run init-db
```

**Важно:** Эта команда создаст:
- Таблицу `products` для товаров
- Таблицу `admin_users` для администраторов
- Пользователя-админа по умолчанию (admin / admin123)

### 4. Запуск проекта

#### Запуск бэкенда

```bash
# В папке backend/
npm start        # Production режим
# или
npm run dev      # Development режим с автоперезагрузкой
```

Бэкенд будет доступен на `http://localhost:5000`

#### Запуск фронтенда

```bash
# В корневой папке проекта
npm start
```

Фронтенд будет доступен на `http://localhost:3000`

## Доступ к админ-панели

1. Откройте браузер и перейдите на `http://localhost:3000/admin/login`
2. Введите учетные данные:
   - **Username:** `admin`
   - **Password:** `admin123`
3. После входа вы будете перенаправлены в админ-панель
4. **Важно:** Смените пароль после первого входа!

## Функционал админ-панели

✅ Просмотр всех товаров из базы данных
✅ Добавление новых товаров
✅ Редактирование существующих товаров
✅ Удаление товаров
✅ Авторизация с JWT токенами
✅ Статистика по категориям

## API Endpoints

### Авторизация

- `POST /api/auth/login` - Вход админа
- `POST /api/auth/verify` - Проверка токена

### Товары

- `GET /api/products` - Получить все товары
- `GET /api/products/:id` - Получить товар по ID
- `POST /api/products` - Создать товар (требует авторизацию)
- `PUT /api/products/:id` - Обновить товар (требует авторизацию)
- `DELETE /api/products/:id` - Удалить товар (требует авторизацию)

### Служебные

- `GET /api/health` - Проверка работы сервера

## Структура проекта

```
RecrentShop/
├── backend/               # Backend API (Node.js + Express)
│   ├── db/               # Конфигурация БД
│   ├── middleware/       # Middleware (auth)
│   ├── routes/           # API роуты
│   ├── scripts/          # Скрипты инициализации
│   ├── .env              # Настройки БД
│   └── server.js         # Главный файл сервера
│
├── src/
│   ├── components/
│   │   └── pages/
│   │       ├── AdminPage.tsx         # Админ-панель
│   │       └── AdminLoginPage.tsx    # Страница входа
│   ├── utils/
│   │   └── auth.ts                   # Утилиты авторизации
│   └── ...
│
├── .env.local            # Переменные окружения фронтенда
├── .env.example          # Пример переменных окружения
└── SETUP_GUIDE.md        # Эта инструкция
```

## Возможные проблемы

### Не удается подключиться к базе данных

- Проверьте настройки в `backend/.env`
- Убедитесь, что база данных доступна
- Проверьте логи бэкенда в консоли

### CORS ошибки

- Убедитесь, что фронтенд запущен на `http://localhost:3000`
- Проверьте настройку `CORS_ORIGIN` в `backend/.env`

### Не работает авторизация

- Проверьте, что бэкенд запущен
- Убедитесь, что в `.env.local` указан правильный `REACT_APP_API_URL`
- Очистите localStorage и попробуйте войти заново

## Деплой

### Frontend (GitHub Pages)

```bash
npm run deploy
```

### Backend

Для деплоя бэкенда используйте любой хостинг с поддержкой Node.js:
- Heroku
- Vercel
- Railway
- DigitalOcean

Не забудьте настроить переменные окружения на хостинге!

## Поддержка

По всем вопросам обращайтесь в Issues на GitHub.
